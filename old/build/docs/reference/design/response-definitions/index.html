<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Praxis Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Praxis Blog Atom Feed"><title data-react-helmet="true">Responses | Praxis</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Responses | Praxis"><meta data-react-helmet="true" name="description" content="Praxis allows API designers to define the set of response templates the"><meta data-react-helmet="true" property="og:description" content="Praxis allows API designers to define the set of response templates the"><meta data-react-helmet="true" property="og:url" content="https://www.praxis-framework.io/docs/reference/design/response-definitions"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.praxis-framework.io/docs/reference/design/response-definitions"><link rel="stylesheet" href="/styles.ab2c79ee.css">
<link rel="preload" href="/styles.27a80096.js" as="script">
<link rel="preload" href="/runtime~main.d759ace7.js" as="script">
<link rel="preload" href="/main.0f7e767c.js" as="script">
<link rel="preload" href="/1.1d955ac3.js" as="script">
<link rel="preload" href="/65.fc2dba12.js" as="script">
<link rel="preload" href="/66.81df1f16.js" as="script">
<link rel="preload" href="/935f2afb.f1e5e5bf.js" as="script">
<link rel="preload" href="/64.4c9a6482.js" as="script">
<link rel="preload" href="/a0da26c3.a99be27b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Praxis</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/gettingStarted/intro">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/reference/intro">Reference</a><a href="https://github.com/praxis/praxis" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Praxis</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/gettingStarted/intro">Getting Started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/reference/intro">Reference</a></li><li class="menu__list-item"><a href="https://github.com/praxis/praxis" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Intro</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/installation">Installation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/designingApiResources">Designing our API resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/settingUpOurDB">Setting Up Our Database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/implementingReads">Implementing Reads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/buildingCRUD">Building CRUD</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Design</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/media-types">Media Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/endpoints">Endpoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/actions">Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/api-definition">General API Definitions</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/reference/design/response-definitions">Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/traits">Traits</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/doc-generation">Document Generation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/multipart">Multipart</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Implementation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/controllers">Controllers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/application">Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/responses">Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/request-life-cycle">Request Life Cycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/multipart">Multipart Types</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Extensions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/mapper-plugin">Mapper Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/pagination-plugin">Pagination Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/field-selection">Field Selection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/filtering">Filtering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/rendering">Rendering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Internals</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/field_selection">FieldSelection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/field_expansion">FieldExpansion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/mapper_selectors">MapperSelectors</a></li></ul></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2WRA"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_CoMu"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Responses</h1></header><div class="markdown"><p>Praxis allows API designers to define the set of response templates the
application can return. By designing a response, you are describing a set of
expectations about its structure and attributes. You then give it a name and
tell Praxis about it using <code>response_template</code>.</p><p>Here is an example of how to design a response definition:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :ok do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description &#x27;An ok response refers to a successful outcome&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type &#x27;application/vnd.acme.user&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Header1&#x27;, value: &#x27;foo&#x27;, description: &#x27;This is a very nais header, which has value foo&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Header2&#x27;, value: /bar/, description: &#x27;This header contains the bar string&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Some-Stuff&#x27;, value: nil, description: &#x27;This only requires the header to exist, with any value&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This creates a response definition named <code>ok</code> with a human-readable description which will be rendered in the API documentation. With this we are declaring that this response will:</p><ul><li>have a status code of 200</li><li>return an <code>application/vnd.acme.user</code> media type (the value of the Content-Type header)</li><li>contain, at least, the following two headers:<ul><li><code>X-Header1</code> which must always match a literal value &quot;foo&quot;</li><li><code>X-Header2</code> which must always match the regular expression <code>/bar/</code></li><li><code>X-Some-Stuff</code> which can have any value</li></ul></li></ul><p>Any action may refer to a response by name when declaring its list of expected
responses. For example, here is a snippet of an action describing
that it can return the <code>ok</code> response defined above.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># somewhere in a resource definition...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action :index do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  routing { get &#x27;&#x27; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response :ok</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>See <a href="/docs/reference/resource-definitions/">ActionDefinitions</a> for more information about
how to specify which responses an action can return.</p><p>Having response templates that have all fields statically defined like our example above, make it more difficult to reuse accross actions. For example, you may want to use the <code>ok</code> definition above for an action that returns an a media-type other than <code>application/vnd.acme.user</code>.</p><p>For this reason, response definitons are parameterizable via block parameters.
For example, introducing a <code>media_type</code> parameter in our previous <code>ok</code> response
could be done like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :ok do |media_type: &#x27;application/vnd.acme.user&#x27;|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description &#x27;An ok response refers to a successful outcome&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type media_type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Header1&#x27;, value: &#x27;foo&#x27;, description: &#x27;This is a very nais header, which has value foo&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Header2&#x27;, value: /bar/, description: &#x27;This header contains the bar string&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Some-Stuff&#x27;, value: nil, description: &#x27;This only requires the header to exist, with any value&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Parameterized responses allow you to reuse registered responses in action definitions with some flexibility:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># somewhere in a resource definition...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action :index do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  routing { get &#x27;&#x27; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response :ok, media_type: &#x27;application/custom&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This example response definition has not just a <code>media_type</code> parameter but
also a default value of &#x27;application/json&#x27;.  This allows you to override the
<code>media_type</code> only when necessary. If you don&#x27;t specify the <code>media_type</code>,
you&#x27;ll get <code>application/json</code>. If you don&#x27;t specify a default, you will have to
explicitly pass a value in every action that uses this response definition.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="preregistered-responses"></a>Preregistered Responses<a class="hash-link" href="#preregistered-responses" title="Direct link to heading">#</a></h2><p>Praxis comes with many common response definitions pre-registered. All of them
also have customizable parameters. Here is how the basic <code>200 Ok</code> response is defined. Note that one can add or override not just the mediatype but also, the location, any header expectations and even the description.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">response_template :ok do |media_type: nil, location: nil, headers: nil, description: nil|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  description( description || base_description ) # description can &quot;potentially&quot; be overriden in an individual action.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  media_type media_type if media_type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  location location if location</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  headers&amp;.each do |(name, value)|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    header(name: name, value: value)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>And there are many others. In particular, Praxis automatically creates a
response definition for every Response class in
<a href="https://github.com/praxis/praxis/blob/master/lib/praxis/responses/http.rb" target="_blank" rel="noopener noreferrer">responses/http.rb</a>.
Each of those definitions will have the name and status code specified in the
<code>self.response_name</code> and <code>self.status</code> of those classes.</p><p>You can use any of these response definitions within your application without
having to register them yourself. You can also override any of them with your
own definition if the default one does not suit your needs.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="defining-response-expectations"></a>Defining Response Expectations<a class="hash-link" href="#defining-response-expectations" title="Direct link to heading">#</a></h2><p>When defining a response, you may include expectations for: status code,
headers, location, media_type and multipart parts.</p><p>All expectations in definitions are optional and potentially parameterizable
with the exception of status code. A status code must always be defined and set
statically. It is possible for multiple responses to share the same status code
as they might differ in other expectations (i.e. different headers) which may
be enough to warrant a different name.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="headers"></a>Headers<a class="hash-link" href="#headers" title="Direct link to heading">#</a></h3><p>The <code>header</code> DSL in a response definition is how we can define expectations on the returned headers of a response. There are three types of expectations we can define:</p><ul><li>Expecting to see a header with a given name, without specifying anything about its value.</li><li>Expecting to see a header with a given name, specifying that its contents will have a literal match to a specific value.</li><li>Expecting to see a header with a given name, specifying that its contents will match a given regular expression.</li></ul><p>Here&#x27;s an example of each type of header definition:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # header field set with a String</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :found do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Header1&#x27;, value: &#x27;foo&#x27;, description: &#x27;This is a very nais header, which has value foo&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Header2&#x27;, value: /bar/, description: &#x27;This header contains the bar string&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers name: &#x27;X-Some-Stuff&#x27;, value: nil, description: &#x27;This only requires the header to exist, with any value&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mediatype"></a>MediaType<a class="hash-link" href="#mediatype" title="Direct link to heading">#</a></h3><p>Use the <code>media_type</code> method to set expectations for the media type of a response. The <code>media_type</code> method can accept:</p><ul><li>a string indicating the full Internet media type identifier</li><li>a complete Praxis MediaType class</li></ul><p>For example:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Praxis media_type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class ExampleMediaType &lt; Praxis::MediaType</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # String media_type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :found do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type &#x27;application/json&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Praxis::MediaType</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :found do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type ExampleMediaType</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Media type passed in via a required named parameter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :found do |media_type: |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type media_type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Using a string for the media-type is equivalent to defining the &#x27;Content-Type&#x27;
header with a string value. The reason for providing a media-type DSL is just a
convenience since (just like <code>Location</code>) it is a common header to use.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="location"></a>Location<a class="hash-link" href="#location" title="Direct link to heading">#</a></h3><p>A response definition can directly define a &#x27;Location&#x27; header using the
<code>location</code> method. This method can accept the same value matchers as any other
headers. In fact, underneath, the location method will call the <code>header</code> with <code>name: &#x27;Location&#x27;</code>. As such, it can also take a description</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :redirection do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 302</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    location &#x27;http://www.example.com&#x27;, description: &#x27;Response to redirect you home&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :created do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 202</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    location /api/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="multipart-responses"></a>Multipart responses<a class="hash-link" href="#multipart-responses" title="Direct link to heading">#</a></h3><p>TODO!! Should we get rid and/or simplify multipart responses????</p><p>Praxis also allows you to define that a given response will be of multipart type. Not only that, but it also allows to define expectations on the individual parts of the multipart response. You can do this by using the <code>parts</code> DSL.</p><p>Currently, the <code>parts</code> DSL only allows you to define a common template
definition to which <em>all</em> parts must comply. In the future, we will extend the
DSL to allow you to define different expectations for each individual part.</p><p>The DSL lets you define parts as if they were complete
sub-requests. This can be done in either of the following ways:</p><ul><li>pass a block with a full response definition. This allows you to define a
part inline, as if it were a new and complete sub-request.</li><li>pass a <code>like</code> parameter which names an existing response definition</li></ul><p>Since a multipart part does not have a status code, Praxis will enforce the
expectation by looking at the value of a special &#x27;Status&#x27; header. The rest of
the fields (headers, location and media_type) are native fields of the part.</p><p>Here are two examples of how to add part expectations using both of these
approaches. Using a response block:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :bulk_create do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type &#x27;multipart/form-data&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    parts do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      status 201</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      media_type &#x27;application/json&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      location  /my_resource/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Using the <code>:like</code> option:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :bulk_create do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type &#x27;multipart/form-data&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    parts like: :create</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Obviously, good reuse of these definitions requires parameterization, so a more
realistic definition of a multipart response could look like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ApiDefinition.define do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response_template :bulk_response do |parts: |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type &#x27;multipart/form-data&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    parts( parts )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You could allow an action to customize parts using the <code>like</code> option or by
passing a full response definition block. Here are some more examples:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Using the :like option for parts like the :ok response</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action :bulk_operation do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  routing { post &#x27;/bulk&#x27; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response :bulk_response, parts: { like: :ok }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Using the :like option for parts like the :ok response, but also overriding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># the media-type of the :ok response</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action :bulk_operation do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  routing { post &#x27;/bulk&#x27; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response :bulk_response, parts: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    like: :ok,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type: ExampleMediaType</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Using a full response block definition</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action :bulk_operation do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  routing { post &#x27;/bulk&#x27; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sub_request = proc do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    status 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    media_type ExampleMediaType</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    headers [&#x27;X-Foo&#x27;,&#x27;X-Bar&#x27;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response :bulk_response, parts: sub_request</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The only reason to not pass the block directly in the response line is that
Ruby would never pass it to the <code>parts</code> parameter, but rather to the response
function. Splitting into a different line to create a <code>proc</code> looks cleaner than
adding the right parenthesis in one line.</p><p>For more information on multipart responses, please see
<a href="/docs/reference/responses/">Responses</a>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/reference/design/api-definition"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« General API Definitions</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/reference/design/traits"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Traits Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preregistered-responses" class="table-of-contents__link">Preregistered Responses</a></li><li><a href="#defining-response-expectations" class="table-of-contents__link">Defining Response Expectations</a><ul><li><a href="#headers" class="table-of-contents__link">Headers</a></li><li><a href="#mediatype" class="table-of-contents__link">MediaType</a></li><li><a href="#location" class="table-of-contents__link">Location</a></li><li><a href="#multipart-responses" class="table-of-contents__link">Multipart responses</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.27a80096.js"></script>
<script src="/runtime~main.d759ace7.js"></script>
<script src="/main.0f7e767c.js"></script>
<script src="/1.1d955ac3.js"></script>
<script src="/65.fc2dba12.js"></script>
<script src="/66.81df1f16.js"></script>
<script src="/935f2afb.f1e5e5bf.js"></script>
<script src="/64.4c9a6482.js"></script>
<script src="/a0da26c3.a99be27b.js"></script>
</body>
</html>