<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Praxis Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Praxis Blog Atom Feed"><title data-react-helmet="true">Pagination Plugin | Praxis</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Pagination Plugin | Praxis"><meta data-react-helmet="true" name="description" content="The PaginationPlugin plugin is a &#x27;meta&#x27;-extension that brings in the pagination and ordering extensions."><meta data-react-helmet="true" property="og:description" content="The PaginationPlugin plugin is a &#x27;meta&#x27;-extension that brings in the pagination and ordering extensions."><meta data-react-helmet="true" property="og:url" content="https://www.praxis-framework.io/docs/reference/extensions/pagination-plugin"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.praxis-framework.io/docs/reference/extensions/pagination-plugin"><link rel="stylesheet" href="/styles.ab2c79ee.css">
<link rel="preload" href="/styles.27a80096.js" as="script">
<link rel="preload" href="/runtime~main.d759ace7.js" as="script">
<link rel="preload" href="/main.0f7e767c.js" as="script">
<link rel="preload" href="/1.1d955ac3.js" as="script">
<link rel="preload" href="/65.fc2dba12.js" as="script">
<link rel="preload" href="/66.81df1f16.js" as="script">
<link rel="preload" href="/935f2afb.f1e5e5bf.js" as="script">
<link rel="preload" href="/64.4c9a6482.js" as="script">
<link rel="preload" href="/051d911d.b78017eb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Praxis</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/gettingStarted/intro">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/reference/intro">Reference</a><a href="https://github.com/praxis/praxis" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Praxis</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/gettingStarted/intro">Getting Started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/reference/intro">Reference</a></li><li class="menu__list-item"><a href="https://github.com/praxis/praxis" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Intro</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/installation">Installation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/designingApiResources">Designing our API resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/settingUpOurDB">Setting Up Our Database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/implementingReads">Implementing Reads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/buildingCRUD">Building CRUD</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/intro">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Design</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/media-types">Media Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/endpoints">Endpoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/actions">Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/api-definition">General API Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/response-definitions">Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/traits">Traits</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/doc-generation">Document Generation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/design/multipart">Multipart</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Implementation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/controllers">Controllers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/application">Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/responses">Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/request-life-cycle">Request Life Cycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/multipart">Multipart Types</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Extensions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/extensions/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/extensions/mapper-plugin">Mapper Plugin</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/reference/extensions/pagination-plugin">Pagination Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/extensions/field-selection">Field Selection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/extensions/filtering">Filtering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/extensions/rendering">Rendering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Internals</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/field_selection">FieldSelection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/field_expansion">FieldExpansion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/mapper_selectors">MapperSelectors</a></li></ul></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2WRA"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_CoMu"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Pagination Plugin</h1></header><div class="markdown"><p>The <code>PaginationPlugin</code> plugin is a &#x27;meta&#x27;-extension that brings in the pagination and ordering extensions.</p><p>Specifically, this extension builds on top of the <code>MapperPlugin</code> extensions, and provides a way to signal the mapper to add sorting and limiting statements to the DB queries.</p><p>With this plugin, in addition to the mapper features, you can equip your application to:</p><ul><li>accept a powerful language for paginating (i.e., restricting the amount of data returned) and sorting results from your clients</li><li>apply those specifications into the DB queries (compatible with field selection and filtering)</li><li>reflect the pagination and sorting requirements into the rendered results</li></ul><p>Neat uh?</p><p>There is really only one thing you need to do to enable all this functionality in your app. Simply define the <code>pagination</code> and <code>order</code> parameters in the right endpoint actions where you want to provide this functionality. Here&#x27;s an example of the parameter types for an action that returns lists of <code>Post</code> media types. In particular, this allows you to use cursor-based pagination on <code>id</code> or <code>title</code> fields, and to control order in which the results are returned:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  params do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    attribute :pagination, Praxis::Types::PaginationParams.for(MediaTypes::Post) do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      by_fields :id, :title</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    attribute :order, Praxis::Extensions::Pagination::OrderingParams.for(MediaTypes::Post)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>That&#x27;s it! Nothing else needs to be done. Your controller will take care of it all when you&#x27;re using the <code>build_query</code> functionality provided by the <code>MapperPlugin</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="parameter-configuration"></a>Parameter configuration<a class="hash-link" href="#parameter-configuration" title="Direct link to heading">#</a></h2><p>Both the <code>PaginationParams</code> and the <code>OrderingParams</code> parameter types accept configuration. This means not only can you customize how to paginate and sort, but you can also do it on a per parameter and per action basis. Let&#x27;s take a look at the existing available configurations.</p><p>The built-in pagination supports two types of collection traversal. What we call <code>page</code>-based vs. <code>cursor</code>-based pagination.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="page-based-pagination"></a>Page-based Pagination<a class="hash-link" href="#page-based-pagination" title="Direct link to heading">#</a></h3><p>Page-based pagination returns part of the collection given a fixed page size and based on the underlying (i.e,. implicit) ordering specification from your datastore. Many relational DBs, for example, return results based on primary key order (i.e., the <code>id</code> field). It is possible, however, to use this type of pagination with specific order if you combine it with the <code>order</code> parameter.</p><p>Typically, this type of pagination is associated with the well known &quot;offset/limit&quot; queries and allows you to jump directly to any of the existing pages of the result set. This pagination type is enabled by using the <code>page</code> parameter:</p><ul><li><code>page=&lt;integer&gt;</code> indicates which page number to retrieve (based on a given page size)</li><li>You can explicitly set the size of a page by also passing in <code>items=&lt;integer&gt;</code></li></ul><p>For example, the following request will return posts 201-250 from the underlying collection (i.e., 5th page of 50 items each)</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;http://localhost:9292/posts?api_version=1&#x27;</span><span class="token plain"> -G </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      --data-urlencode </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pagination=page=5,items=50&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Note that, in addition to URL-encode the whole query string parameter, you need to URL-escape the <code>value</code> portion of the pagination param to clearly differentiate from the parameter name. i.e., escaped_value=URLescape(<code>page=5,items=50</code>), URLencode(pagination=escaped_value)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cursor-based-pagination"></a>Cursor-based Pagination<a class="hash-link" href="#cursor-based-pagination" title="Direct link to heading">#</a></h3><p>Cursor-based pagination is usually a more deterministic way to traverse an entire collection (independent from DB internals). However, this type of pagination does not allow jumping directly to any page of the collection as it requires you to know the last seen value.</p><p>This pagination type is enabled by utilizing the <code>by</code> parameter:</p><ul><li><code>by=&lt;field name&gt;</code> allows traversal of the collection based on ascending order of that field&#x27;s values</li><li>you can also use the <code>from=&lt;field value&gt;</code>, as a way to start the collection from values after the given one. The collection returned when no from value is specified is the very first in the result set.</li><li>like in the case of page-based pagination, the page size can be overridden by using <code>items=&lt;integer&gt;</code>. There is a ceiling on the value of items you can set, based on the global configured value in the plugin (See <a href="#global-plugin-configuration">global Plugin&#x27;s configuration</a>)</li></ul><p>For example, the following API request will logically sort all users by their <code>email</code> address, in ascending order, and return [up to] 100 users after the one that has an email value of &quot;<a href="mailto:joe@example.com" target="_blank" rel="noopener noreferrer">joe@example.com</a>&quot;.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;http://localhost:9292/users?api_version=1&#x27;</span><span class="token plain"> -G </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      --data-urlencode </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pagination=by=email,from=joe@example.com,items=100&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Note that there is a dependency between using field-based cursor pagination and the sorting order that one might want for the results returned. In other words, the system will let you know if the use of the <code>by</code> clause in this pagination mode is incompatible with the requested sort <code>order</code> parameter.
Also note that while the system will not prevent one from doing so, cursor-based pagination when using a non-unique field should be avoided. If you do so, it is possible to &#x27;skip over&#x27; and miss out on elements in the result sets such that you never know they exist (i.e., the <code>from</code> parameter would skip same value elements).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="total-count-header"></a>Total-Count Header<a class="hash-link" href="#total-count-header" title="Direct link to heading">#</a></h3><p>Regardless of the type of pagination used, one can also request to receive the total count of elements existing in the collection (pre-paging) by adding <code>total_count=true</code> to the pagination string. When specified, a <code>Total-Count</code> header will be returned containing the total number of existing collection items (pre-pagination). Note that this calculation incurs an extra DB query (i.e., a SELECT COUNT(*) on the same predicate), thus it has extra performance implications.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="link-header"></a>Link Header<a class="hash-link" href="#link-header" title="Direct link to heading">#</a></h3><p>Praxis also will return a <code>Link</code> header following rfc5988, where the client can easily find links to navigate the collection in a more agnostic way (i.e., <code>first</code>, <code>next</code>, <code>prev</code> and <code>last</code> relations).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="tldr-examples"></a>TLDR: examples<a class="hash-link" href="#tldr-examples" title="Direct link to heading">#</a></h3><p>Here are some other types of pagination examples:</p><ul><li><code>page=2</code> Retrieve the second page of elements from the collection (i.e. elements 101-200 since the default page size is 100)</li><li><code>page=4,items=50</code>	Retrieve the fourth page of 50 elements from the collection (i.e. elements 151-200)</li><li><code>by=id</code> Retrieve the first set of elements from the collection based on the ascending order of their id field (ie: first 100 elements since the default page size is 100)</li><li><code>by=name,from=alice</code> Retrieve a page worth of elements from the collection based on the ascending order of their name field, starting at the first value after &quot;alice&quot;.</li><li><code>page=1,total_count=true</code> Retrieve the first page of elements from the collection (page-based unknown sorting), and include the total count in the Total-Count header.</li></ul><p>Note: These example values are presented in the raw syntax, but they will all need to be properly encoded when passed in the query string parameters. For example: <code>pagination=page%3D1%2Ctotal_count%3Dtrue</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ordering"></a>Ordering<a class="hash-link" href="#ordering" title="Direct link to heading">#</a></h3><p>Endpoint actions that provide the order parameter allow you to specify the order with which the collection will be presented. Built-in sorting supports a syntax inspired by the JSON-API specification. It allows you to sort by multiple fields to resolve tie-breakers, and each field can be defined with a <code>-</code> or <code>+</code> sign to indicate descending or ascending order. The lack of sign defaults to ascending order.</p><p>Here are some handy examples:</p><ul><li><code>-id</code>: Sort by the values of the id field, in descending order</li><li><code>name,-start_date,id</code>: Sort by name values, then by descending order of start_date, and finally by id</li></ul><p>The names of the fields to sort must be valid attributes in the associated media type, or the request will fail with a validation error.</p><p>You can also restrict which fields you allow to sort by, by using the <code>by_fields</code> definition when you&#x27;re declaring the <code>OrderingParams</code> parameter. Here&#x27;s how to do it if you want to only allow sorting by <code>id</code> or <code>name</code> for your users:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  attribute :order, Praxis::Extensions::Pagination::OrderingParams.for(MediaTypes::Post) do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    by_fields :id, :name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Restricting the allowed fields is a common practice as allowing to sort by arbitrary fields might also have performance implications if the underlying datastore does not have indices for them.</p><p>It is very nice to provide nested sorting capabilities to the API clients (i.e., sort by name first, then by email, then by...) even though some of these properties clearly will not be indexed by the datastore. On the other hand, the first component of that sort clause can clearly have a performance penalty when not indexed. To provide more flexibility, and allow both more index control, yet deep nested sorts, we provide a configuration option that can ensure that either all sorting components belong to the allowed <code>by_fields</code> list, or that only the first one needs to belong to it. To configure that use the <code>enforce_for</code> stanza. By default only the first component of the sort clause needs to match one of the <code>by_fields</code> if specified.</p><p>For instance, with the <code>by_fields :id, :name</code> example above, the client can properly sort using things like <code>id,email, other</code>, or <code>name,id,other</code> cause it is only enforcing that the first component is either <code>id</code> or <code>name</code> (default of <code>enforce_for :first</code>).</p><p>If we wanted to restrict that even more we change the parameter definition like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  attribute :order, Praxis::Extensions::Pagination::OrderingParams.for(MediaTypes::Post) do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    by_fields :id, :name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    enforce_for :all</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>in which case &quot;all&quot; of the order fields would have to be in the <code>id</code> or <code>name</code> set. That means <code>id,name</code> or <code>name,id</code> will succeed, but even things like <code>id,created_at</code> would not.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="enabling-the-plugin"></a>Enabling the Plugin<a class="hash-link" href="#enabling-the-plugin" title="Direct link to heading">#</a></h2><p>In order to be able to use the <code>PaginationParams</code> and the <code>OrderingParams</code>, you need to enable this plugin. You can do so by simply requiring its file and tell Praxis to use it within a <code>configure</code> block. For example, adding these pieces in the <code>config/environment.rb</code> file:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">require &#x27;praxis/plugins/pagination_plugin&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Praxis::Application.configure do |application|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Use the Mapper plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  application.bootloader.use Praxis::Plugins::PaginationPlugin, **{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    max_items: 500,  # Unlimited by default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This plugin also supports a good amount of global options and therefore it is fairly configurable. The default configuration, however, would probably suit most applications.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="global-plugin-configuration"></a>Global Plugin configuration<a class="hash-link" href="#global-plugin-configuration" title="Direct link to heading">#</a></h2><p>Here are the list of globally configurable defaults</p><ul><li><code>max_items</code>: The maximum number of results that a paginated response will ever allow. Unlimited by default,</li><li><code>default_page_size</code>: The default page size to use when no <code>items</code> is specified. 100 by default.</li><li><code>disallow_paging_by_default</code>: Disallows the use of the page type pagination mode when true (i.e., using &#x27;page=&#x27; parameter, Defaults to false.</li><li><code>disallow_cursor_by_default</code>: Disallows the use of the cursor type pagination mode when true (i.e., using &#x27;by=&#x27; or &#x27;from=&#x27; parameter). Defaults to false.</li><li><code>paging_default_mode</code>: The default mode params hash to use. Defaults to  { page: 1 }</li><li><code>sorting</code>: Weather or not to enforce that <em>all</em> requested sort fields must be of the <code>by_fields</code> attributes. Defaults to { enforce_all_fields: false }, which means only the first attribute must meet the requirement</li></ul><p>And here&#x27;s an example of how to configure all of the default values for the plugin when registering it:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Praxis::Application.configure do |application|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  application.bootloader.use Praxis::Plugins::PaginationPlugin, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    max_items: 3000,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    default_page_size: 200,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    disallow_paging_by_default: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    disallow_cursor_by_default: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    paging_default_mode: {by: :id}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sorting: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      enforce_all_fields: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Like any other plugin, you can also choose to configure the exact same parameters through <code>config.pagination</code> hash:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Praxis::Application.configure do |application|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  application.config.pagination.max_items = 3000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  application.config.pagination.default_page_size = 3000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/reference/extensions/mapper-plugin"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Mapper Plugin</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/reference/extensions/field-selection"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Field Selection Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#parameter-configuration" class="table-of-contents__link">Parameter configuration</a><ul><li><a href="#page-based-pagination" class="table-of-contents__link">Page-based Pagination</a></li><li><a href="#cursor-based-pagination" class="table-of-contents__link">Cursor-based Pagination</a></li><li><a href="#total-count-header" class="table-of-contents__link">Total-Count Header</a></li><li><a href="#link-header" class="table-of-contents__link">Link Header</a></li><li><a href="#tldr-examples" class="table-of-contents__link">TLDR: examples</a></li><li><a href="#ordering" class="table-of-contents__link">Ordering</a></li></ul></li><li><a href="#enabling-the-plugin" class="table-of-contents__link">Enabling the Plugin</a></li><li><a href="#global-plugin-configuration" class="table-of-contents__link">Global Plugin configuration</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.27a80096.js"></script>
<script src="/runtime~main.d759ace7.js"></script>
<script src="/main.0f7e767c.js"></script>
<script src="/1.1d955ac3.js"></script>
<script src="/65.fc2dba12.js"></script>
<script src="/66.81df1f16.js"></script>
<script src="/935f2afb.f1e5e5bf.js"></script>
<script src="/64.4c9a6482.js"></script>
<script src="/051d911d.b78017eb.js"></script>
</body>
</html>