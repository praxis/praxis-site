<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Praxis Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Praxis Blog Atom Feed"><title data-react-helmet="true">Multipart | Praxis</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Multipart | Praxis"><meta data-react-helmet="true" name="description" content="Praxis has built-in support for defining and handling &quot;multipart/form-data&quot; requests and responses (rfc2388 &amp; friends). This support is mostly provided by the underlying Praxis::MultipartOk response."><meta data-react-helmet="true" property="og:description" content="Praxis has built-in support for defining and handling &quot;multipart/form-data&quot; requests and responses (rfc2388 &amp; friends). This support is mostly provided by the underlying Praxis::MultipartOk response."><meta data-react-helmet="true" property="og:url" content="https://www.praxis-framework.io/docs/reference/design/multipart"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.praxis-framework.io/docs/reference/design/multipart"><link rel="stylesheet" href="/styles.ab2c79ee.css">
<link rel="preload" href="/styles.27a80096.js" as="script">
<link rel="preload" href="/runtime~main.d759ace7.js" as="script">
<link rel="preload" href="/main.0f7e767c.js" as="script">
<link rel="preload" href="/1.1d955ac3.js" as="script">
<link rel="preload" href="/65.fc2dba12.js" as="script">
<link rel="preload" href="/66.81df1f16.js" as="script">
<link rel="preload" href="/935f2afb.f1e5e5bf.js" as="script">
<link rel="preload" href="/64.4c9a6482.js" as="script">
<link rel="preload" href="/e95b762b.2999fe20.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Praxis</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/gettingStarted/intro">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/reference/intro">Reference</a><a href="https://github.com/praxis/praxis" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="Praxis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Praxis</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/gettingStarted/intro">Getting Started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/reference/intro">Reference</a></li><li class="menu__list-item"><a href="https://github.com/praxis/praxis" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Intro</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/installation">Installation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/designingApiResources">Designing our API resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/settingUpOurDB">Setting Up Our Database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/implementingReads">Implementing Reads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gettingStarted/buildingCRUD">Building CRUD</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Design</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/media-types">Media Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/endpoints">Endpoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/actions">Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/api-definition">General API Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/response-definitions">Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/traits">Traits</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/design/doc-generation">Document Generation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/reference/design/multipart">Multipart</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Implementation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/controllers">Controllers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/application">Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/responses">Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/request-life-cycle">Request Life Cycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/implementation/multipart">Multipart Types</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Extensions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/mapper-plugin">Mapper Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/pagination-plugin">Pagination Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/field-selection">Field Selection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/filtering">Filtering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/extensions/rendering">Rendering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Internals</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/field_selection">FieldSelection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/field_expansion">FieldExpansion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/internals/mapper_selectors">MapperSelectors</a></li></ul></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2WRA"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_CoMu"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Multipart</h1></header><div class="markdown"><p>Praxis has built-in support for defining and handling &quot;multipart/form-data&quot; requests and responses (<a href="https://www.ietf.org/rfc/rfc2388.txt" target="_blank" rel="noopener noreferrer">rfc2388</a> &amp; friends). This support is mostly provided by the underlying <code>Praxis::Types::MultipartArray</code> type, and the <code>Praxis::Responses::MultipartOk</code> response.</p><p>The <code>MultipartArray</code> type is the main piece of code use to handle decoding/encoding multipart structures. It is typically used to define the structure of incoming multipart payloads, as well as used to create proper multipart bodies in API responses. In particular, it is a type defined as a <code>Attributor::Collection</code> of <code>Praxis::MultipartPart</code> type members that allows you to describe each part of a multipart request or response body.</p><p>The <code>MultipartOk</code> response class (and corresponding template) is a simlple thin layer on top of the <code>Ok</code> response that makes it easier to compose multipart responses in your controllers.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="designing-multipart-structures"></a>Designing Multipart structures<a class="hash-link" href="#designing-multipart-structures" title="Direct link to heading">#</a></h2><p>The <code>MultipartArray</code> is a fully compatible <code>Attributor</code> type, that can:</p><ul><li>load, coerce and validate incoming multipart payload bodies, transforming them in instances of <code>MultipartArray</code></li><li>use the <code>MultipartArray</code> features to generate fully multipart objects that are ready to be sent as response payloads. </li></ul><p>The <code>MultipartArray</code> dsl allows defining its inner parts in several ways. The most common way is to list out the structure of each of the expected parts. And this can be done, with the <code>part</code> DSL, which explicitly the structure each of the parts will have. This can be done for each explicit part name, or it can be done in groups, as defined by a regexp on the name. The name regexp method allows to define the same structure for multiple parts that match the same name regexp (very useful when you might be receiving an unknown list of related parts for which you cannot know the name in advance).</p><p>It is common for multipart bodies to contain parts that are to be treated as files. For that you can annotate a part with <code>filename: true</code> or simply use the <code>file</code> DSL instead (they are equivalent).</p><p>Defining each type follows the rules of any other attribute definition you&#x27;re used to crafting in any Media Type or action payload/parameter definition. Therefore it accepts common options like <code>:description</code> or <code>:required</code>, <code>:default</code> etc...Like any other attribute, the type of a part can be any <code>Attributor</code> type. This means you can define a part to be a simple <code>String</code> (maybe even with some expected regexp check), a <code>Struct</code>, a <code>Hash</code> or any other type that you are used to having.</p><p>Here&#x27;s a made up example of a large multipart payload that showcases different ways to use the DSL:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class NamedPartsExample &lt; Praxis::Types::MultipartArray</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # a simple part named &quot;title&quot; with default payload type (i.e., a String)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;title&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # a part named &quot;uri&quot; with a URI payload</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;uri&#x27;, URI</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # a part named &quot;contents&quot; </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;contents&#x27; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # that should have a Content-Type header of &quot;application/json&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    header &#x27;Content-Type&#x27;, &#x27;application/json&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # and be loadable as a Hash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    payload Hash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # zero or more parts with names ending in &quot;_at&quot; must contain DateTimes payloads</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part /_at$/, DateTime</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # a summary part, which is required</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;summary&#x27;, String, required: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # zero or more parts whose name matches /nam/, with String payloads that must match Bob</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part(/nam/, String, regexp: /Bob/i)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # zero or more parts whose name matches /stuff/ that contain objects loadable as Hashes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part /stuff/ do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    payload Hash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # potentially multiple parts named &#x27;files&#x27;, each of which are expected to have </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # contain an octet-stream, a filename (matching /file/) and loaded as a tempfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  file &#x27;files&#x27;, multiple: true do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    header &#x27;Content-Type&#x27;, &#x27;application/octet-stream&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    filename String, regexp: /file/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    payload Attributor::Tempfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # a thumbnail part with a filename attribute, which will be loaded as a tempfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  file &#x27;thumbnail&#x27;, Attributor::Tempfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # an part named image with a filename attribute, which will be loaded as a tempfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;image&#x27;, Attributor::Tempfile, filename: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>So in general you can use the following features when defining <code>MultipartArray</code>s:</p><ul><li><code>part &lt;STRING&gt;</code> is the DSL to define the structure of a part by explicit name</li><li><code>part &lt;REGEXP&gt;</code> is the DSL to define the structure of any part whose name matches the regexp</li><li><code>file &lt;STRING&gt;|&lt;REGEXP&gt;</code> is an alias to <code>part</code> which explicitly adds the <code>filename: true</code> option.</li></ul><p>The <code>part</code> (or <code>file</code>) DSL, accepts multiple options. In particular:</p><ul><li><code>required</code> if true, the loading and validation will fail if that part isn&#x27;t provided</li><li><code>multiple</code> if true, it will allow collecting multiple parts with the same exact name. When this option is set the corresponding part becomes an array.</li></ul><p>The type of the payload of a part is defined by providing a block. Each of the underlying part structures will be backed by the <code>MultipartPart</code>-derived class. This block can define the following expected characteristics for the part structure:</p><ul><li><code>header</code>: defines an expectation for that part to have a header matching the name, and possibly a regexp  (syntax is the same as defining a String attribute). Note you can define multiple headers by adding muliple lines.</li><li><code>filename</code>: define an expectation on the filename attribute of the part (syntax is the same as defining a String attribute)</li><li><code>payload</code>: define the expected type of the payload (syntax is the same as defining any attribute in a mediatype or payload)</li></ul><p>NOTE: For simple type payloads with no other expectations, you can use a type directly as the first parameter on the <code>part</code>, and skip any further block definition. Look at some examples above (i.e., the <code>uri</code> or <code>title</code> parts).</p><p>While uncommon, it is also possible to define a multipart payload in a much more fuzzy manner. This can be achieved by not using the <code>part</code> or <code>file</code> DSL at all, but simply using <code>name_type</code> and <code>payload_type</code> as a way to define multipart content where all parts are identical in payload structure. It is probably not very common at all to go this route, as dynamic parts can be probably be more clearly defined using the <code>part</code> DSL with a name regex. But just for completeness, here is an example of how to use these methods to define that all part names are of type <code>String</code> and all the part payloads are of type <code>Hash</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class SimpleExample &lt; Praxis::Types::MultipartArray</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name_type String</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  payload_type Hash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Using <code>String</code> as the type name means that Praxis will not perform any validation or coercion on part names. Also
both <code>name_type</code> and <code>payload_type </code>are optional and not specifying one is equivalent to using the <code>String</code> type.</p><p>Here is a more less convoluted example of defining a multipart type that defines several
parts in different ways:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class ImageUpload &lt; Praxis::Types::MultipartArray</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Image author, loaded (and validated) as pre-defined Author type  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;author&#x27;, Author, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    required: true, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description: &#x27;Authorship information&#x27;  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Set of tags, as strings. May be specified more than once.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;tags&#x27;, String,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    multiple: true, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description: &#x27;Category name. May be given multiple times&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Any part whose name ends in &#x27;_at&#x27; should be a DateTime</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part /_at$/, description: &#x27;Timestamp information for the set of files&#x27; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    payload DateTime</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # The parser will save uploaded file as a Ruby Tempfile.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Note: This maps to the Attributor::Tempfile type.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;image&#x27;, Tempfile, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    required: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    filename: true, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description: &#x27;Image to upload&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Ensure the incoming thumbnail is a jpeg with proper filename&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  file &#x27;thumbnail&#x27;, description: &#x27;Image thumbnail, must be jpeg&#x27; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    header &#x27;Content-Type&#x27;, &#x27;image/jpeg&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    payload Attributor::Tempfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    filename values: [&#x27;thumb.jpg&#x27;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="returning-multipart-responses"></a>Returning Multipart Responses<a class="hash-link" href="#returning-multipart-responses" title="Direct link to heading">#</a></h2><p>In the same way that we have support for designing incoming multipart payloads for our actions, Praxis also allows you to define multipart payloads of responses of your actions.</p><p>To do so, you can take advantage of the <code>:multipart_ok</code> response template. As we previously said, this is a simple template wrapper for a <code>200 Ok</code> response, but that defines a <code>MultipartArray</code> as its default mediatype type.</p><p>With that defined, you can any action can use a <code>response :multipart_ok ...</code> by:</p><ul><li>directly passing an already <code>MultipartArray</code>-derived type to it. </li><li>or by passing the generic type, and fully defining one inline with a block.</li></ul><p>Here&#x27;s how you could reuse an already defined type (i.e., our <code>ImageUpload</code> type above) for it:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">response :multipart_ok, ImageUpload</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>And here&#x27;s how you&#x27;d define the multipart type inline:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">response :multipart_ok, Praxis::Types::MultipartArray do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;name&#x27;, String</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;timestamps&#x27; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    attribute &#x27;created_at&#x27;, DateTime</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    attribute &#x27;updated_at&#x27;, DateTime</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  part &#x27;address&#x27;, Address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/reference/design/doc-generation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Document Generation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/reference/implementation/controllers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Controllers Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#designing-multipart-structures" class="table-of-contents__link">Designing Multipart structures</a></li><li><a href="#returning-multipart-responses" class="table-of-contents__link">Returning Multipart Responses</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.27a80096.js"></script>
<script src="/runtime~main.d759ace7.js"></script>
<script src="/main.0f7e767c.js"></script>
<script src="/1.1d955ac3.js"></script>
<script src="/65.fc2dba12.js"></script>
<script src="/66.81df1f16.js"></script>
<script src="/935f2afb.f1e5e5bf.js"></script>
<script src="/64.4c9a6482.js"></script>
<script src="/e95b762b.2999fe20.js"></script>
</body>
</html>